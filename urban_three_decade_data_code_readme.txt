Data and analysis codes used in Frolking S, R Mahtta, T Milliman, T Esch, KC Seto. 2024-in press. From spreading out to building up – the evolution of global urban structural growth over three decades, Nature Cities.PART 1. DATA FILESPART 2. ANALYSIS CODESPART 3. REFERENCESPART 1. DATA FILESThere are four csv data files that are read by the codes and used to generate figures and tables in the paper. There are also a few files used in QGIS, 1 shape file of MUA polygons, and some raster geotiff files; these are listed after the CSV files.global_china_total_floor_area_data.csv• annual floor area from IEA (2022), global total, also partitioned into ‘advanced’ and ‘developing/emerging’ economies; areas in billion m2.• Accumulating annual new floor area completed for China (billion m2) and Beijing and Shanghai (million m2). First year of data for Shanghai was 1978 so 51 million m2 had accumulated from then through 1985. Annual increments reported in online statistical yearbooks for China, Beijing, Shanghai (see reference list below).mua_country_list_economy_region.csv• list of countries with MUAs used in this study.‘mua_country_code’ id number from Taubenbock et al. 2019; ‘region_1’ is one of 12 global regions ‘economy’ is ‘advanced’ or ‘other’ (‘other’ = ‘developing/emerging’) according to IEA (2022).  Sub_regions’ divides ‘Africa’ into 5 sub-regions (north, south, east, west, central) and ‘Other Asia’ into 2 sub-regions (south, central).  All other regions are listed also as sub-regions.mua_city_list_lat_lon_clean_Jul2023.csv• list of individual MUAs (or cities) and some of their properties, from Taubenbock et al. (2019).mua_objectid: from Taubenbock et al. (2019);mua_country_code: from Taubenbock et al. (2019);mua_country: from Taubenbock et al. (2019);mua_worldpop_thousands: from Taubenbock et al. (2019) (from 2014 UN data);mua_area_m2: (polygon area) from Taubenbock et al. (2019);mua_aggname_short: from Taubenbock et al. (2019), shortened if compound (multi-city) name;mua_cell_count: number of 0.05° grid cells touching MUA polygon, including those with water > 50%;mua_mean_lon: mean longitude of all grid cells in MUA, not used in analysismua_mean_lat: mean latitude of all grid cells in MUA, not used in analysisregion_1: region of MUA’s countryeconomy: economy of MUA’s countrysub_regions: sub-region of MUA’s countryglobal_mua_grid_variables_table_wat_lt_50_NA.csv• multiple variables for all grid cells in all MUAs included in the study.  NOTE: the working csv file of all grid data included a number of variables that were not used in the end.  These have all been replace with 'NA' and their column names with NA1 through NA57NOTE: to upload to github this was split into two parts: PART 1 has data for first 20,000 grid cells, PART 2 has data for remaining 14,880 grid cells.  Concatentate these two files before running scripts.• Grid cell properties and names: longitude; latitude; mua_objectid; mua_fid1; mua_country_code; mua_cellcount; mua_worldpop_thousand; mua_area_km2; mua_country; mua_aggname; grid_area_m2; water_pct; region_1; economy• summer mean backscatter PR [PR = 10^[sigma_0/10)] with sigma_0 in dB; sigma_0 values from Frolking et al. (2022):ERS (1993-2000), QSCAT (1999-2009 in northern hemisphere, 2000-2009 in southern hemisphere)ASCAT (2007-2021)• backscatter decadal trends computed with ‘lm’ in Rers_slope; ers_slope_stderr; ers_slope_r2; ers_slope_pval;qscat_slope; qscat_slope_stderr; qscat_slope_r2; qscat_slope_pval;ascat_10_21_slope; ascat_10_21_slope_stderr; ascat_10_21_slope_r2; ascat_10_21_slope_pval;• WSF3D building metrics (from World Settlement Footprint 3D) (not used in three-decade analysis); second set of values is smoothed over 3x3 grid of grid cells, using mean smoothingWSF3D_Vol_sum; WSF3D_BF_mean; WSF3D_BA_sum; WSF3D_HT_mean; WSF3D_Vol_sum_3x3smooth; WSF3D_BF_mean_3x3smooth; WSF3D_BA_sum_3x3smooth; WSF3D_HT_mean_3x3smooth• WSF-evolution percent built for 1985-2015 (from World Settlement Footprint Evolution)WSFEvolution_1985_mean, … , WSFEvolution_2015_mean• annualized rate of increase in WSFEvolution built fraction:del_wsf_bf_93_00; del_wsf_bf_99_09; del_wsf_bf_10_15GIS files:Figure ED8 is generated in QGIS using a shape file for MUA polygons from Taubenbock et al. (2019) (Morphological_Urban_Area.shp), and a raster geotiff file identifying all 0.05° lat/lon grid cells that intersect with the MUA polygon shape file (mua_mask.tif).  A second set of raster geotiff files are used to make Fig. 1.  These files are generated in one of the R codes below.PART 2. ANALYSIS CODESThere are six R codes that generate most of the figures in the paperFigure 1 is generated in QGIS using a geotiff raster files for gridded bivariate values.  These geotiff files are generated in bivariate_choropleth_plots_v3.R (below).BF_&_PR_timeseries_and_v_floor_area_and_accel_decel_plots.RReads four input files:• global_china_total_floor_area_data.csv• global_mua_grid_variables_table_wat_lt_50_NA.csv• mua_city_list_lat_lon_clean_Jul2023.csv• mua_country_list_economy_region.csvGenerates seven pdf files, two 12-panel time series figures (Fig. Extended Data ED1), one 8-panel BF and PR vs. floor area figures (Fig. ED2), a single panel time series for three cities in Syria (Fig. ED7), and three multi-panel pdf files of mean PR and BF interdecadal acceleration/deceleration arrows (Fig. 3), using intercalibrated sensor trends • backscatter_&_bf_v_floor_area_plots.pdf• region_mean_timeseries_PR_WSFevo.pdf• mua_mean_timeseries_PR_WSFevo.pdf• syria_city_timeseries.pdf• mua_mean_growth_rate_PR_WSFevo.pdf• region_mean_growth_rate_PR_WSFevo.pdf• subregion__mean_growth_rate_PR_WSFevo.pdfcity_backscatter_PR_v_WSF3D_plots.RReads one input file:• global_mua_grid_variables_table_wat_lt_50_NA.csvGenerates one pdf file containing three 12-panel scatterplot figures of ASCAT PR vs. smoothed WSF3D building volume, building height, and building fraction area (Fig. Supplemental S2)• mua_12_ascat_v_wsf3d.pdfbackscatter_sensor_PR_trend_intercalibration.RReads three input files:• global_mua_grid_variables_table_wat_lt_50_NA.csv• mua_city_list_lat_lon_clean_Jul2023.csv• mua_country_list_economy_region.csvGenerates one pdf file containing a 4-panel scatterplot of scatterometer sensor PR trends for ‘overlapping years (Fig. ED9):• scatterometer_trend_intercalibration_plot.pdfAsia_region_BF_&_PR_trends_by_pop_bin.RReads three input files:• global_mua_grid_variables_table_wat_lt_50_NA.csv• mua_city_list_lat_lon_clean_Jul2023.csv• mua_country_list_economy_region.csvGenerates one pdf file containing two 4-panel box-whisker plots of BF & PR trends by decade, binned by city population, for East Asia, China, Southeast Asia, and India (Fig. ED4):• regional_grid_trends_binned_by_pop.pdfbivariate_choropleth_plots_v3.RReads three input files:• global_mua_grid_variables_table_wat_lt_50_NA.csv• mua_city_list_lat_lon_clean_Jul2023.csv• mua_country_list_economy_region.csvGenerates 9 csv files that can be used to construct Table 1:• region_bivariate_cluster_stats_Y1_Y2.csv               where Y1_Y2 Is 93_00 r 99_09 or 10_21• sub_region_bivariate_cluster_stats_Y1_Y2.csv      where Y1_Y2 Is 93_00 r 99_09 or 10_21• economy_bivariate_cluster_stats_Y1_Y2.csv          where Y1_Y2 Is 93_00 r 99_09 or 10_21Generates two pdf files containing a number of three panel pages of plots of grid cell number by growth type, city population, and decade, one page of each region or sub-region (Figs. 2, ED3, S1):• regional_grid_trends_binned_by_pop.pdfGenerates three geotiff files for loading into QGIS for the city map panels in Fig. 1• ascat_intercal_wsfevo_10_21_6bin_grid.tif• ers_intercal_wsfevo_10_21_6bin_grid.tif• qscat_wsfevo_10_21_6bin_grid.tifkmeans_cluster_analysis_by_decade.R  Reads three input files:• global_mua_grid_variables_table_wat_lt_50_NA.csv• mua_city_list_lat_lon_clean_Jul2023.csv• mua_country_list_economy_region.csvGenerates 2 csv files: one giving stats on the clusters (similar to info in box-whisker plots in Fig. ED5), and includes the number of grid cells per cluster per decade (used in Table 2), and the second giving number of grid cells per region, sub-region, and country (used in Figs. 4, ED6, S3)• grid_1990s_5_&_2000s_5_&_2010s_5kmeans_cluster_stats_array.• grid_1990s_5_&_2000s_5_&_2010s_5_region_and_sub_region_and_country_num_grids.csv        Generates one pdf file containing a series of alluvial plots of k-means cluster transitions between decades: global, regional, sub-regional (used to make Figs. 4, ED6, S3):• grid_1990s_5_&_2000s_5_&_2010s_5_kMeans_cluster_alluvial.pdfGenerates one pdf file containing a series box-whisker plots that characterize the k-means clusters (used to make Fig. ED5):• grid_1990s_5_&_2000s_5_&_2010s_5_BFs_&_PRs_state_&_change_cluster_box_plots.pdfGenerates three geotiff files of the clusters by decade (note that cluster 1 typology in one decade may not match cluster 1 typology in another decade, so care is needed with these)• kmeans_cluster_5_1990s_raster_grid.tif• kmeans_cluster_5_2000s_raster_grid.tif• kmeans_cluster_5_2010s_raster_grid.tif
PART 3. REFERENCESH. Taubenböck, M. Weigand, T. Esch, J. Staab, M. Wurm, J. Mast, S. Dech, A new ranking of the world’s largest cities—Do administrative units obscure morphological realities? Remote Sens. Environ. 232, 111353 (2019). [data in online supplement]S. Frolking, T. Milliman, R. Mahtta, A. Paget, D. G. Long, K. C. Seto, Global Monthly and Seasonal Urban and Land Backscatter Time Series, 1993-2020, Palisades, NY: NASA Socioeconomic Data and Applications Center (SEDAC) (2022); https://doi.org/10.7927/GR2E-DH86.IEA, “World Energy Outlook 2022” (Paris, 2022); https://www.iea.org/reports/world-energy-outlook-2022.China Statistical Yearbook 2022 (China Statistics Press, 2022; http://www.stats.gov.cn/sj/ndsj/2022/indexeh.htm.Beijing Statistical Yearbook 2021 (China Statistics Press, Beijing Municipal Bureau of Statistics and NBS Survey Office in Beijing, 2021; https://nj.tjj.beijing.gov.cn/nj/main/2021-tjnj/zk/indexeh.htm.Shanghai Statistical Yearbook 2020 (2020; https://tjj.sh.gov.cn/tjnj/zgsh/tjnj2020en.html.World Settlement Footprint 3D: data are available at https://download.geoservice.dlr.de/WSF3D/files/. World Settlement Footprint Evolution data are available at https://download.geoservice.dlr.de/WSF_EVO/.1